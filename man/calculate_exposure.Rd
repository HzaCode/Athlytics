% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_exposure.R
\name{calculate_exposure}
\alias{calculate_exposure}
\title{Calculate Training Load Exposure (ATL, CTL, ACWR)}
\usage{
calculate_exposure(
  stoken,
  activity_type = c("Run", "Ride", "VirtualRide", "VirtualRun"),
  load_metric = "duration_mins",
  acute_period = 7,
  chronic_period = 42,
  user_ftp = NULL,
  user_max_hr = NULL,
  user_resting_hr = NULL,
  end_date = NULL
)
}
\arguments{
\item{stoken}{A valid Strava token from `rStrava::strava_oauth()`.}

\item{activity_type}{Type(s) of activities to include (e.g., "Run", "Ride").
Default includes common run/ride types.}

\item{load_metric}{Method for calculating daily load (e.g., "duration_mins",
"distance_km", "tss", "hrss"). Default "duration_mins".}

\item{acute_period}{Days for the acute load window (e.g., 7).}

\item{chronic_period}{Days for the chronic load window (e.g., 42). Must be greater than `acute_period`.}

\item{user_ftp}{Required if `load_metric = "tss"`. Your Functional Threshold Power.}

\item{user_max_hr}{Required if `load_metric = "hrss"`. Your maximum heart rate.}

\item{user_resting_hr}{Required if `load_metric = "hrss"`. Your resting heart rate.}

\item{end_date}{Optional. Analysis end date (YYYY-MM-DD string or Date). Defaults to today.
The analysis period covers the `chronic_period` days ending on this date.}
}
\value{
A data frame with columns: `date`, `daily_load`, `atl` (Acute Load),
  `ctl` (Chronic Load), and `acwr` (Acute:Chronic Ratio) for the analysis period.
}
\description{
Calculates training load metrics like ATL, CTL, and ACWR from Strava data.
}
\details{
Fetches activities within a specified date range, calculates daily load
based on a chosen metric (e.g., duration, TSS, HRSS), and computes
Acute Training Load (ATL), Chronic Training Load (CTL), and the
Acute:Chronic Workload Ratio (ACWR).

This function provides the data used by `plot_exposure`. It automatically
  fetches activities for a longer period before the analysis start date to ensure
  the initial CTL calculation is accurate. Depending on the chosen `load_metric`,
  you may need to provide `user_ftp` (for TSS) or `user_max_hr` and `user_resting_hr` (for HRSS).
}
\examples{
\dontrun{
# Requires authentication first:
# stoken <- rStrava::strava_oauth(..., cache = TRUE)

# Exposure using TSS for Rides
ride_exposure_tss <- calculate_exposure(
    stoken = stoken,
    activity_type = "Ride",
    load_metric = "tss",
    user_ftp = 280,
    acute_period = 7,
    chronic_period = 28
)
print(head(ride_exposure_tss))

# Exposure using HRSS for Runs
run_exposure_hrss <- calculate_exposure(
    stoken = stoken,
    activity_type = "Run",
    load_metric = "hrss",
    user_max_hr = 190,
    user_resting_hr = 50
)
print(tail(run_exposure_hrss))
}
}
