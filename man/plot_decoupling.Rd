% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_decoupling.R
\name{plot_decoupling}
\alias{plot_decoupling}
\title{Plot Aerobic Decoupling Trend}
\usage{
plot_decoupling(
  stoken,
  activity_type = c("Run", "Ride"),
  decouple_metric = c("Pace_HR", "Power_HR"),
  start_date = NULL,
  end_date = NULL,
  min_duration_mins = 45,
  max_activities = 50,
  add_trend_line = TRUE,
  smoothing_method = "loess",
  decoupling_df = NULL
)
}
\arguments{
\item{stoken}{A valid Strava token from `rStrava::strava_oauth()`. Required unless `decoupling_df` is provided.}

\item{activity_type}{Type(s) of activities to analyze (e.g., "Run", "Ride").}

\item{decouple_metric}{Metric basis: "Pace_HR" or "Power_HR".}

\item{start_date}{Optional. Analysis start date (YYYY-MM-DD string or Date). Defaults to ~1 year ago.}

\item{end_date}{Optional. Analysis end date (YYYY-MM-DD string or Date). Defaults to today.}

\item{min_duration_mins}{Minimum activity duration (minutes) to include. Default 45.}

\item{max_activities}{Max number of recent activities to fetch/analyze. Default 50.}

\item{add_trend_line}{Add a smoothed trend line (`geom_smooth`)? Default `TRUE`.}

\item{smoothing_method}{Smoothing method for trend line (e.g., "loess", "lm"). Default "loess".}

\item{decoupling_df}{Optional. A pre-calculated data frame from `calculate_decoupling`.
If provided, `stoken` and other calculation parameters are ignored.}
}
\value{
A ggplot object showing the decoupling percentage trend. Lower values
  generally indicate better aerobic endurance.
}
\description{
Visualizes the trend of aerobic decoupling over time.
}
\details{
Calculates or uses pre-calculated aerobic decoupling data (heart rate drift
relative to pace or power) and creates a ggplot showing the trend.
Fetching the required data can be slow.

Aerobic decoupling reflects changes in efficiency (Output/HR) during
  an activity. It's calculated as: (EF_1st_half - EF_2nd_half) / EF_1st_half * 100.
  Positive values indicate HR drift. A common reference threshold is 5%.

  **Warning:** If data is not provided via `decoupling_df`, this function calls
  `calculate_decoupling`, which fetches detailed activity streams from Strava.
  This can be very slow and hit API rate limits.
}
\examples{
\dontrun{
# Requires authentication first:
# stoken <- rStrava::strava_oauth(..., cache = TRUE)

# Plot Pace/HR decoupling for recent Runs (limit to 30)
plot_decoupling(stoken = stoken,
                activity_type = "Run",
                decouple_metric = "Pace_HR",
                max_activities = 30)

# Plot Power/HR decoupling for recent Rides
plot_decoupling(stoken = stoken,
                activity_type = "Ride",
                decouple_metric = "Power_HR")

# Plot pre-calculated decoupling data
# decoupling_results <- calculate_decoupling(...)
# plot_decoupling(decoupling_df = decoupling_results)
}
}
